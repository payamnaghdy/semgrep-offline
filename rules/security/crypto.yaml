rules:
  - id: weak-hash-md5
    pattern: hashlib.md5(...)
    message: "MD5 is cryptographically weak. Use SHA-256 or stronger for security purposes."
    languages: [python]
    severity: WARNING
    metadata:
      cwe: "CWE-328"
      owasp: "A02:2021 - Cryptographic Failures"

  - id: weak-hash-sha1
    pattern: hashlib.sha1(...)
    message: "SHA1 is deprecated for security purposes. Use SHA-256 or stronger."
    languages: [python]
    severity: WARNING
    metadata:
      cwe: "CWE-328"
      owasp: "A02:2021 - Cryptographic Failures"

  - id: weak-random
    patterns:
      - pattern: random.random()
      - pattern: random.randint(...)
      - pattern: random.choice(...)
      - pattern: random.randrange(...)
    message: "random module is not cryptographically secure. Use secrets module for security purposes."
    languages: [python]
    severity: INFO
    metadata:
      cwe: "CWE-330"
      owasp: "A02:2021 - Cryptographic Failures"

  - id: hardcoded-password
    patterns:
      - pattern: $VAR = "..."
        metavariable-regex:
          metavariable: $VAR
          regex: (?i)(password|passwd|pwd|secret|api_key|apikey|api_secret|token|auth_token|access_token)
    message: "Potential hardcoded credential detected. Use environment variables or secure vault."
    languages: [python]
    severity: ERROR
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"

  - id: hardcoded-secret-dict
    pattern: |
      {..., "$KEY": "...", ...}
    metavariable-regex:
      metavariable: $KEY
      regex: (?i)(password|passwd|pwd|secret|api_key|apikey|api_secret|token|auth_token|access_token|private_key)
    message: "Potential hardcoded secret in dictionary. Use environment variables."
    languages: [python]
    severity: WARNING
    metadata:
      cwe: "CWE-798"
      owasp: "A07:2021 - Identification and Authentication Failures"

  - id: django-secret-key-hardcoded
    patterns:
      - pattern: SECRET_KEY = "..."
      - pattern: SECRET_KEY = '...'
    message: "Hardcoded Django SECRET_KEY detected. Use environment variables: SECRET_KEY = os.environ.get('SECRET_KEY')"
    languages: [python]
    severity: ERROR
    metadata:
      cwe: "CWE-798"
      owasp: "A02:2021 - Cryptographic Failures"

  - id: flask-secret-key-hardcoded
    pattern: app.secret_key = "..."
    message: "Hardcoded Flask secret key. Use environment variable instead."
    languages: [python]
    severity: ERROR
    metadata:
      cwe: "CWE-798"
      owasp: "A02:2021 - Cryptographic Failures"

  - id: django-hashers-weak-md5
    pattern: |
      PASSWORD_HASHERS = [..., "django.contrib.auth.hashers.MD5PasswordHasher", ...]
    message: "MD5 password hasher is insecure. Use Argon2 or PBKDF2 instead."
    languages: [python]
    severity: ERROR
    metadata:
      cwe: "CWE-328"
      owasp: "A02:2021 - Cryptographic Failures"

  - id: django-hashers-weak-sha1
    pattern: |
      PASSWORD_HASHERS = [..., "django.contrib.auth.hashers.SHA1PasswordHasher", ...]
    message: "SHA1 password hasher is weak. Use Argon2 or PBKDF2 instead."
    languages: [python]
    severity: WARNING
    metadata:
      cwe: "CWE-328"
      owasp: "A02:2021 - Cryptographic Failures"
